ENV HCP_SERVICES="enroll attest swtpm"
ENV HCP_ENROLLSVC_STATE_PREFIX=/state/enrollsvc
ENV HCP_RUN_ENROLL_SIGNER=/creds/asset-signer
ENV HCP_RUN_ENROLL_GENCERT=/creds/gencert-CA
ENV HCP_RUN_ENROLL_REALM=REALM.EXAMPLE.XYZ
ENV HCP_ATTESTSVC_STATE_PREFIX=/state/attestsvc
ENV HCP_ATTESTSVC_REMOTE_REPO=git://caboodle/enrolldb
ENV HCP_ATTESTSVC_UPDATE_TIMER=10
ENV HCP_SWTPMSVC_STATE_PREFIX=/state/swtpmsvc
ENV HCP_SWTPMSVC_ENROLL_HOSTNAME=host.realm.example.xyz
ENV HCP_SWTPMSVC_ENROLL_API=http://caboodle:5000
ENV HCP_RUN_CLIENT_VERIFIER=/creds/asset-verifier
ENV HCP_CLIENT_ATTEST_URL=http://caboodle:8080
ENV HCP_RUN_CLIENT_TPM2TOOLS_TCTI=swtpm:host=caboodle,port=9876

RUN mkdir -p $HCP_ENROLLSVC_STATE_PREFIX
RUN mkdir -p $HCP_ATTESTSVC_STATE_PREFIX
RUN mkdir -p $HCP_SWTPMSVC_STATE_PREFIX

RUN mkdir -p $HCP_RUN_ENROLL_SIGNER
RUN mkdir -p $HCP_RUN_ENROLL_GENCERT
RUN mkdir -p $HCP_RUN_CLIENT_VERIFIER

RUN /hcp/caboodle/regen-creds.sh
