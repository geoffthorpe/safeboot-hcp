{
    "_": " vim: set expandtab shiftwidth=4 softtabstop=4: ",

    "services": [
        "fqdn_updater",
        "attester",
        "sshsvc",
        "sshd"
    ],
    "default_targets": [
        "start-presetup",
        "start-attester",
        "setup-global",
        "setup-local",
        "start-postsetup"
    ],
    "args_for": "sshd",

    "fqdn_updater": {
        "exec": "/hcp/common/fqdn_updater.py",
        "until": "/etc/hcp-fqdn-alive",
        "nowait": 1,
        "tag": "presetup",
        "env": {
            "unset": { "HCP_NOTRACEFILE": null }
        },
        "path": "/fqdn-bus",
        "refresh": 5,
        "expiry": 20,
        "hostnames": [ "sherver" ],
        "default_domain": "hcphacking.xyz",
        "bad_address": "100.100.100.100"
    },

    "attester": {
        "exec": "/hcp/common/attester.py",
        "until": "/etc/hcp-attested",
        "nowait": 1,
        "tag": "attester",
        "env": {
            "unset": {
                "HCP_NOTRACEFILE": null
            }
        },
        "period": 120,
        "env": {
            "set": {
                "HCP_ATTESTCLIENT_HOOK_KRB5KEY": "/hcp/sshsvc/hup_sshd.sh"
            }
        }
    },
    "client": {
        "exec": "/hcp/tools/run_client.sh",
        "touchfile": "/etc/hcp-attested",
        "env": {
            "unset": { "HCP_NOTRACEFILE": null }
        },
        "attest_url": "http://ahcp.hcphacking.xyz:8080",
        "tcti": "swtpm:path=/tpm_socket_sherver/tpm",
        "callbacks": [ "/hcp/tools/attest_callback_common.py" ]
    },

    "sshsvc": {
        "setup": [ {
                "tag": "global",
                "exec": "/hcp/sshsvc/setup_global.sh",
                "touchfile": "/sherver/initialized"
            }, {
                "tag": "local",
                "exec": "/hcp/sshsvc/setup_local.sh",
                "touchfile": "/etc/hcp-sherver-local-setup"
            } ],
        "state": "/sherver"
    },

    "sshd": {
        "setup": { "touchfile": "/etc/hcp-sherver-local-setup" },
        "exec": "/usr/sbin/sshd",
        "args": [ "-e", "-D" ],
        "tag": "postsetup"
    }
}
